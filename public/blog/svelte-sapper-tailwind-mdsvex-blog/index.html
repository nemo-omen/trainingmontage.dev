<!DOCTYPE html> <html lang=en> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <base href=/ > <link href=css/global.css rel=stylesheet> <link href=manifest.json rel=manifest> <meta content=#3F83F8 name=theme-color> <link href=favicon.png rel=icon type=image/png> <link href=/apple-touch-icon-180.png rel=apple-touch-icon sizes=180x180> <link href=https://fonts.gstatic.com rel=preconnect> <link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,300;0,400;0,700;0,900;1,300;1,400;1,700&family=Oswald:wght@200;300;400;500;600;700&display=swap" rel=stylesheet> <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,300;0,400;0,500;0,600;1,300;1,400;1,500;1,600&display=swap" rel=stylesheet> <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@200;300;400;500;600;700&display=swap" rel=stylesheet> <style>.blog-section p{margin-bottom:3rem}code:not(pre){font-family:'IBM Plex Mono','Courier New',Courier,monospace;color:var(--light-gray);background-color:var(--dark-gray);font-weight:400;padding:0 .25rem 3px .25rem}.blog-section pre{background-color:var(--dark-gray)!important;border-radius:0!important;margin-bottom:3rem!important}.blog-section pre code{font-family:'IBM Plex Mono','Courier New',Courier,monospace;font-weight:400}.language-svelte>.token.script,.language-svelte>.token.style{display:block}.language-svelte>.token.script,.language-svelte>.token.style{text-indent:2em}.sidebar.svelte-12d7ehb.svelte-12d7ehb.svelte-12d7ehb{background-color:var(--dark-gray);color:var(--light-gray)}.sidebar a{color:var(--light-blue)}.sidebar a:hover{color:var(--blue)}.sidebar-body.svelte-12d7ehb.svelte-12d7ehb.svelte-12d7ehb{padding:1rem}.sidebar-body.svelte-12d7ehb>.svelte-12d7ehb+.svelte-12d7ehb{margin-top:2rem}.heading-xl.svelte-12d7ehb.svelte-12d7ehb.svelte-12d7ehb{font-size:2.875rem;font-weight:400;line-height:1.375}.meta.svelte-12d7ehb.svelte-12d7ehb.svelte-12d7ehb{margin-top:1.5rem;color:var(--light-blue)}.meta.svelte-12d7ehb p.svelte-12d7ehb.svelte-12d7ehb{line-height:1}.meta.svelte-12d7ehb p.svelte-12d7ehb+.svelte-12d7ehb{margin-top:.5rem}.expo.svelte-12d7ehb.svelte-12d7ehb.svelte-12d7ehb{font-style:italic}@media(min-width:600px){.heading-xl.svelte-12d7ehb.svelte-12d7ehb.svelte-12d7ehb{font-size:3.25rem}.sidebar-body.svelte-12d7ehb.svelte-12d7ehb.svelte-12d7ehb{padding:2rem}.sidebar-body.svelte-12d7ehb>.svelte-12d7ehb+.svelte-12d7ehb{margin-top:2.25rem}}@media(min-width:768px){.heading-xl.svelte-12d7ehb.svelte-12d7ehb.svelte-12d7ehb{font-size:3.5rem}.sidebar-body.svelte-12d7ehb.svelte-12d7ehb.svelte-12d7ehb{padding:2.5rem}.sidebar-body.svelte-12d7ehb>.svelte-12d7ehb+.svelte-12d7ehb{margin-top:2.5rem}}@media(min-width:1024px){.sidebar.svelte-12d7ehb.svelte-12d7ehb.svelte-12d7ehb{width:40%;min-width:40%}.heading-xl.svelte-12d7ehb.svelte-12d7ehb.svelte-12d7ehb{font-size:3.75rem}.sidebar-body.svelte-12d7ehb.svelte-12d7ehb.svelte-12d7ehb{padding:2.75rem}.sidebar-body.svelte-12d7ehb>.svelte-12d7ehb+.svelte-12d7ehb{margin-top:2.75rem}.extra.svelte-12d7ehb.svelte-12d7ehb.svelte-12d7ehb{height:var(--sidebarHeight)}}@media(min-width:1280px){.sidebar.svelte-12d7ehb.svelte-12d7ehb.svelte-12d7ehb{width:33%;min-width:33%}.heading-xl.svelte-12d7ehb.svelte-12d7ehb.svelte-12d7ehb{font-size:3.75rem}.sidebar-body.svelte-12d7ehb.svelte-12d7ehb.svelte-12d7ehb{padding:3rem}.sidebar-body.svelte-12d7ehb>.svelte-12d7ehb+.svelte-12d7ehb{margin-top:3rem}.extra.svelte-12d7ehb.svelte-12d7ehb.svelte-12d7ehb{height:var(--sidebarHeight)}}nav.svelte-k4nsv2.svelte-k4nsv2{display:flex;flex-direction:row;font-family:var(--sans);padding:0 1rem}nav.svelte-k4nsv2 a.svelte-k4nsv2{display:block;padding:1rem .5rem;color:var(--light-gray);transition-property:all;transition-duration:.3s;text-decoration:none}nav.svelte-k4nsv2 a.svelte-k4nsv2:hover{background:var(--light-gray);color:var(--dark-gray)}.active.svelte-k4nsv2.svelte-k4nsv2{background:var(--light-gray);color:var(--dark-gray)}@media(min-width:600px){nav.svelte-k4nsv2.svelte-k4nsv2{padding:0 2rem}}@media(min-width:768px){nav.svelte-k4nsv2.svelte-k4nsv2{padding:0 2.5rem}}@media(min-width:1024px){nav.svelte-k4nsv2.svelte-k4nsv2{padding:0 2.75rem}}@media(min-width:1280px){nav.svelte-k4nsv2.svelte-k4nsv2{padding:0 3rem}}.table-of-contents.svelte-1wytrfj{padding:2rem 0;margin:0 auto;position:-webkit-sticky;position:sticky;top:2rem}.toc-heading.svelte-1wytrfj{font-size:1.875rem;font-weight:400}.toc-list.svelte-1wytrfj{padding:1rem 2rem 0 0;margin:0}.toc-item.svelte-1wytrfj{list-style-type:none;margin:0;padding:.25rem 0 0 0;font-size:1.25rem;font-family:var(--sans);font-weight:400}</style> <title> Blog/svelte-sapper-tailwind-mdsvex-blog </title><link href=css/prism-nord.css rel=stylesheet data-svelte=svelte-19rg6km> <link href=/client/client.adf0f3e4.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/svelte-sapper-tailwind-mdsvex-blog.587bd385.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/Sidebar.e5e4e031.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/blog.cc4ea91b.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/inject_styles.5607aec6.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/Sidebar-8f8e6ffe.css rel=preload as=style><link href=/client/blog-76e8af22.css rel=preload as=style><link href=/client/svelte-sapper-tailwind-mdsvex-blog-9bf0ff5a.css rel=preload as=style></head> <body> <div id=sapper> <div id=app> <aside class="svelte-12d7ehb sidebar"><nav class=svelte-k4nsv2 id=top><a href=/ rel=prefetch class="svelte-k4nsv2 normal">home</a> <a href=/blog rel=prefetch class="svelte-k4nsv2 active">blog</a> <a href=/about rel=prefetch class="svelte-k4nsv2 normal">about</a> </nav> <section class="svelte-12d7ehb sidebar-body"><hgroup class=svelte-12d7ehb><h1 class="svelte-12d7ehb heading-xl">Blogging with Sapper, Tailwind, and mdsvex: Part 1</h1> <section class="svelte-12d7ehb meta"><p class=svelte-12d7ehb>Jeff Caldwell</p> <p class=svelte-12d7ehb>Tuesday, December 15, 2020</section></hgroup> <p class="svelte-12d7ehb expo">How I made this site using Svelte/Sapper, TailwindCss, and mdsvex</p> <section class="svelte-12d7ehb extra"> <section class="svelte-1wytrfj table-of-contents"><h4 class="svelte-1wytrfj toc-heading">Table of Contents</h4> <ul class="svelte-1wytrfj toc-list"><li class="svelte-1wytrfj toc-item"><a href=/blog/svelte-sapper-tailwind-mdsvex-blog#top>Top</a></li> </ul> </section></section></section> </aside> <main><section class=blog-section><p>Learning frontend web-development can be pretty tough. Aside from the months you have to spend learning all of the basics of CSS, HTML, and JavaScript, you have to contend with a myriad of available frameworks, build tools, hosting, and on, and on. So it’s nice when people make libraries and tools to make that process easier.</p> <p><a href=https://svelte.dev/ rel=nofollow>Svelte</a>, and the framework built on top of it, <a href=https://sapper.svelte.dev/ rel=nofollow>Sapper</a>, along with <a href=https://tailwindcss.com/ rel=nofollow>TailwindCss</a> and <a href=https://mdsvex.pngwn.io/ rel=nofollow>mdsvex</a> make the task of creating a markdown blog much easier, though there are still plenty of ways it can go wrong. So, let’s walk through the process I went through to set this site up. Along the way I’ll write about why I made the decisions I did, the mistakes I made, and how I got around them.</p> <p>With any luck we’ll both learn something.</p> <p><strong>But first…</strong></p> <p>Before I start writing about this, let me just say that I know <a href=https://svelte.dev/blog/whats-the-deal-with-sveltekit rel=nofollow>SvelteKit</a> is on the way and will most likely make Sapper obsolete. Still, Rich Harris has said that the Svelte contributors are taking pains to make the transition from Sapper to SvelteKit pretty painless. I think this means that learning to use Sapper will transfer over to SvelteKit (as a matter of fact, I’ve tried some of the techniques I’ll go over using SvelteKit, so, with some minor changes in syntax, a lot of this should still apply.)</p> <h2 id=getting-started>Getting Started</h2> <p>Generally, getting started with a Svelte or Sapper app entails cloning one of their templates using <a href=https://www.npmjs.com/package/degit rel=nofollow>Degit</a>, which essentially clones a git repository and removes the <code>.git</code> directory. We’re not going to copy the official <a href=https://github.com/sveltejs/sapper-template rel=nofollow>sveltejs/sapper template</a> for this project, though. Why? Because the process of getting Tailwind, Sapper and mdsvex working together in a way that ensures all the features of each library play well together is a real pain in the butt and someone else has done a fantastic job of figuring it out.</p> <p>What we’re going to start with is Jacob Babich’s fantastic <a href=https://github.com/babichjacob/sapper-postcss-template rel=nofollow>sapper-postcss-template</a>. There are other ways to integrate Tailwind with Svelte, some of them are really simple to set up, but they didn’t work with the way I’ve been using Tailwind (which I’ll leave for another discussion). For now, let’s just grab the template and get going.</p> <pre class="code-pre line-numbers language-bash"><code class=language-bash>npx degit babichjacob/sapper-postcss-template<span class="token comment">#main my-blog</span></code></pre> <p>What this command does is grab whatever repo you provide as the first argument, in this case <code>babichjacob/sapper-postcss-template</code>, and copy it into whatever directory you provide as the second argument — <code>my-blog</code> (or whatever you want to name the directory). If the template lives in a different branch than <code>master</code>, as many Github repos have started to do this year, you’ll need to append the branch name with a hash — <code>#main</code> for this repo. If you wanted to you could also create a directory first, <code>cd</code> into the <em>empty</em> directory and use </p> <pre class="code-pre line-numbers language-bash"><code class=language-bash>npx degit babichjacob/sapper-postcss-template<span class="token comment">#main .</span></code></pre> <p>So, now we have a directory full of Jacob Babich’s template files. Let’s take a look at what’s in there.</p> <img alt="my-blog directory structure" height=450 loading=lazy src=img/posts/12-15-20/12-15-20_Screenshot01.png width=225 class=small-img> <p>Mostly the template is the base Sapper template with some additional files that work to integrate Sapper with PostCss and Tailwind. Let’s spin this sucker up and see what’s what, shall we?</p> <p>First, we need to install all of the dependencies. <a href=https://pnpm.js.org/en/ rel=nofollow>pnpm</a> is an alternative to npm that helps save disk space by keeping all of your dependencies on a <em>content-addressable filesystem</em> on your hard drive. It then links to packages in that filesystem from the <code>node_modules</code> directory in your project. This way, if you already have a dependency installed from another project, you don’t have to take up more disk space by installing it again. <a href=https://pnpm.js.org/en/motivation rel=nofollow>It’s pretty cool</a>!</p> <p>If you want to use pnpm and don’t have it installed yet, you can go ahead and install it with</p> <pre class="code-pre line-numbers language-bash"><code class=language-bash><span class="token function">npm</span> <span class="token function">install</span> -g <span class="token function">pnpm</span></code></pre> <p>If you don’t want to use it, you can just follow along using <code>npm</code> in place of <code>pnpm</code> for any of the commands.</p> <p>Okay, back to the project. Install the dependencies.</p> <pre class="code-pre line-numbers language-bash"><code class=language-bash><span class="token function">pnpm</span> <span class="token function">install</span></code></pre> <p>Now let’s get the dev-server running.</p> <pre class="code-pre line-numbers language-bash"><code class=language-bash><span class="token function">pnpm</span> run dev</code></pre> <p>Which will do a bunch of fun stuff in your terminal.</p> <img alt="Terminal output of pnpm run dev command" height=450 loading=lazy src=img/posts/12-15-20/12-15-20_Screenshot02.png width=800> <p>If you open your browser to <a href=http://localhost:3000 rel=nofollow>http://localhost:3000</a> you’ll see the sapper template in all its glory</p> <img alt="Heeey! It's Sapper with Tailwind!" height=450 loading=lazy src=img/posts/12-15-20/12-15-20_Screenshot03.png width=800> <h2 id=getting-comfortable>Getting Comfortable</h2> <p>Now that we have the base template up and running. Let’s take a look at some of the files that make it work. Open up <code>svelte.config.js</code>, located in the root of your project’s directory.</p> <pre class="code-pre line-numbers language-js"><code class=language-js><span class="token comment">//svelte.config.js</span>

<span class="token keyword">const</span> sveltePreprocess <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"svelte-preprocess"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> postcss <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./postcss.config"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function function-variable">createPreprocessors</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> sourceMap <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">[</span>
	<span class="token function">sveltePreprocess</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		sourceMap<span class="token punctuation">,</span>
		defaults<span class="token operator">:</span> <span class="token punctuation">{</span>
			style<span class="token operator">:</span> <span class="token string">"postcss"</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		postcss<span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token comment">// You could have more preprocessors, like mdsvex</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	createPreprocessors<span class="token punctuation">,</span>
	<span class="token comment">// Options for `svelte-check` and the VS Code extension</span>
	preprocess<span class="token operator">:</span> <span class="token function">createPreprocessors</span><span class="token punctuation">(</span><span class="token punctuation">{</span> sourceMap<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>Normally, this stuff would be in <code>rollup.config.js</code>, but it’s been separated into its own module here. This is where we’ll add mdsvex later. For now, just know that this is where we’ll be setting up any preprocessors. This file requires <code>postcss.config.js</code>, so let’s take a look at that file next.</p> <pre class="code-pre line-numbers language-js"><code class=language-js><span class="token comment">//postcss.config.js</span>

<span class="token keyword">const</span> cssnano <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"cssnano"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> postcssImport <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"postcss-import"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> tailwindcss <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"tailwindcss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> tailwindcssConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./tailwind.config"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> mode <span class="token operator">=</span> <span class="token string">"production"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> dev <span class="token operator">=</span> mode <span class="token operator">===</span> <span class="token string">"development"</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
		postcssImport<span class="token punctuation">,</span>

		<span class="token function">tailwindcss</span><span class="token punctuation">(</span>tailwindcssConfig<span class="token punctuation">)</span><span class="token punctuation">,</span>

		<span class="token comment">// Plugins for polyfills and the like (such as postcss-preset-env) should generally go here</span>
		<span class="token comment">// but a few have to run *before* Tailwind</span>

		<span class="token operator">!</span>dev <span class="token operator">&&</span> <span class="token function">cssnano</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			preset<span class="token operator">:</span> <span class="token punctuation">[</span>
				<span class="token string">"default"</span><span class="token punctuation">,</span>
				<span class="token punctuation">{</span> discardComments<span class="token operator">:</span> <span class="token punctuation">{</span> removeAll<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token punctuation">]</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>Boolean<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>This is where we start getting into the nitty-gritty of making PostCss and Tailwind work with Svelte. If you have PostCss plugins to add, this is the place to do that. Let’s look at the other important config file that this file imports, <code>tailwind.config.js</code></p> <pre class="code-pre line-numbers language-js"><code class=language-js><span class="token comment">// tailwind.config.js</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> tailwindExtractor <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"tailwindcss/lib/lib/purgeUnusedStyles"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	purge<span class="token operator">:</span> <span class="token punctuation">{</span>
		content<span class="token operator">:</span> <span class="token punctuation">[</span>
			<span class="token string">"./src/**/*.html"</span><span class="token punctuation">,</span>
			<span class="token string">"./src/**/*.svelte"</span><span class="token punctuation">,</span>
		<span class="token punctuation">]</span><span class="token punctuation">,</span>
		options<span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token function function-variable">defaultExtractor</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">[</span>
				<span class="token comment">// This is an internal Tailwind function that we're not supposed to be allowed to use</span>
				<span class="token comment">// So if this stops working, please open an issue at</span>
				<span class="token comment">// https://github.com/babichjacob/sapper-postcss-template/issues</span>
				<span class="token comment">// rather than bothering Tailwind Labs about it</span>
				<span class="token operator">...</span><span class="token function">tailwindExtractor</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">,</span>
				<span class="token comment">// Match Svelte class: directives (https://github.com/tailwindlabs/tailwindcss/discussions/1731)</span>
				<span class="token operator">...</span><span class="token punctuation">[</span><span class="token operator">...</span>content<span class="token punctuation">.</span><span class="token function">matchAll</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token language-regex regex-source">(?:class:)*([\w\d-/:%.]+)</span><span class="token regex-delimiter">/</span><span class="token regex-flags">gm</span></span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>_match<span class="token punctuation">,</span> group<span class="token punctuation">,</span> <span class="token operator">...</span>_rest<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> group<span class="token punctuation">)</span><span class="token punctuation">,</span>
			<span class="token punctuation">]</span><span class="token punctuation">,</span>
			keyframes<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	theme<span class="token operator">:</span> <span class="token punctuation">{</span>
		extend<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	variants<span class="token operator">:</span> <span class="token punctuation">{</span>
		extend<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>For the most part, this file is exactly the same as the default <code>tailwind.config.js</code> that comes when you initialize a new Tailwind project, with one big exception: <code>defaultExtractor</code>. This is a custom function for matching against Svelte <a href=https://svelte.dev/docs#class_name rel=nofollow>class</a> directives. This function is part of the reason this template is so awesome. Don’t mess with that function if you don’t know what you’re doing! Otherwise, this is where you’ll customize your tailwind configuration.</p> <p>Okay, so those are the config files. There are two last files of note that we should take a look at. The first is <code>src/global.pcss</code>, which is the file that imports all of Tailwind’s components and compiled css:</p> <pre class="code-pre line-numbers language-css"><code class=language-css><span class="token atrule"><span class="token rule">@import</span> <span class="token string">"tailwindcss/base"</span><span class="token punctuation">;</span></span>
<span class="token comment">/* @import "./base.pcss"; */</span>

<span class="token atrule"><span class="token rule">@import</span> <span class="token string">"tailwindcss/components"</span><span class="token punctuation">;</span></span>
<span class="token comment">/* @import "./components.pcss"; */</span>

<span class="token atrule"><span class="token rule">@import</span> <span class="token string">"tailwindcss/utilities"</span><span class="token punctuation">;</span></span>
<span class="token comment">/* @import "./utilities.pcss"; */</span></code></pre> <p>You can add global styles to this file by adding:</p> <pre class="code-pre line-numbers language-css"><code class=language-css><span class="token atrule"><span class="token rule">@layer</span> base</span> <span class="token punctuation">{</span>
    // your expert-level css here
<span class="token punctuation">}</span></code></pre> <p>Lastly, let’s look at the file that gets compiled by this fantastic Rube Goldberg Machine of config files, <code>static/global.css</code>. I’m not going to show you the code here because the file is more than 3MB. This is basically everything that makes Tailwind work while you’re in development. When you eventually build for production this will be whittled down to some small number of kilobytes. What you should remember here is <strong>don’t edit this file or add your own styles to it</strong>. It will all be overwritten.</p> <p>Okay, enough looking at all of these config files. Let’s actually make a blog!</p> <h2 id=adding-mdsvex>Adding mdsvex</h2> <p><a href=https://mdsvex.pngwn.io/ rel=nofollow>mdsvex</a> is a project by <a href=https://twitter.com/evilpingwin rel=nofollow>pngwn</a> that aims to introduce some of the functionality of <a href=https://mdxjs.com/ rel=nofollow>mdx</a> to Svelte. Basically, mdsvex, allows you to write Svelte template code and some js in your markdown files. This is super-ideal for a blog made with Svelte/Sapper because you never really know when you’ll want to execute some real code in your markdown posts.</p> <p>Let’s install it and start playing around, shall we?</p> <pre class="code-pre line-numbers language-bash"><code class=language-bash><span class="token function">pnpm</span> <span class="token function">install</span> mdsvex -D</code></pre> <p>We’re installing <code>mdsvex</code> as a dev dependency here because we want this blog to be served as a static site. Later, when we export the static site from Sapper or use Netlify’s automated build process, those dev dependencies are what will be used in the build process.</p> <p>Once that’s installed, we need to add it to our preprocessors over in <code>svelte/config.js</code> open that up again and we’ll import <code>mdsvex</code>:</p> <pre class="code-pre line-numbers language-diff"><code class=language-diff>//svelte.config.js

const sveltePreprocess = require("svelte-preprocess");
const postcss = require("./postcss.config");
<span class="token inserted inserted-sign"><span class="token inserted prefix">+</span> const { mdsvex } = require('mdsvex');
</span>

const createPreprocessors = ({ sourceMap }) => [
<span class="token inserted inserted-sign"><span class="token inserted prefix">+</span>   mdsvex({}),
</span>
	sveltePreprocess({
		sourceMap,
		defaults: {
			style: "postcss",
		},
		postcss,
	}),
	// You could have more preprocessors, like mdsvex
];

module.exports = {
	createPreprocessors,
	// Options for `svelte-check` and the VS Code extension
	preprocess: createPreprocessors({ sourceMap: true }),
};
</code></pre> <p>It’s important to add <code>mdsvex({})</code> <em>above</em> <code>sveltePreprocess</code> here. My first mistake when building this blog was to place <code>mdsvex({})</code> right after the comment <code>//you could have more preprocessors, like mdsvex</code>. I’m guessing this didn’t work because <code>sveltePreprocess</code> works on <code>.svelte</code> files, while mdsvex actually builds <code>.svelte</code> files from markdown, metadata, and abstract syntax trees through remark. Basically, if you try to hand <code>sveltePreprocess</code> a bunch of markdown it will tell you, cryptically, that it can’t do what you want. </p> <p>mdsvex, by default, works with the <code>.svx</code> file extension. We’ll get to writing actual <code>.svx</code> files in a bit. First, let’s look at a feature of mdsvex: layouts.</p> <p>First, add the following to <code>svelte.config.js</code>:</p> <pre class="code-pre line-numbers language-diff"><code class=language-diff>//svelte.config.js

const sveltePreprocess = require("svelte-preprocess");
const postcss = require("./postcss.config");
const { mdsvex } = require('mdsvex');
<span class="token inserted inserted-sign"><span class="token inserted prefix">+</span> const path = require('path');
</span>
const createPreprocessors = ({ sourceMap }) => [
<span class="token unchanged"><span class="token prefix unchanged"></span>  mdsvex({
</span><span class="token inserted inserted-sign"><span class="token inserted prefix">+</span>   layout: {
<span class="token inserted prefix">+</span>       blog: path.resolve(__dirname, 'src/layouts/blog.svelte'),
<span class="token inserted prefix">+</span>       default: path.resolve(__dirname, 'src/layouts/default.svelte'),
</span><span class="token unchanged"><span class="token prefix unchanged"></span>   }
</span>
...</code></pre> <p>We’re specifying two layout files here, one for the blog posts, and one as our default layout. We could just specify the single layout for blog posts if we wanted, but I wanted to highlight that we can specify multiple layouts for our <code>.svx</code> files. It’s important to note here that any layout files you specify in this config <em>need to exist at the location you specify</em> or you’ll get an ugly error.</p> <p>Now, let’s create the layout files in the directory we specified. Create a directory at <code>src/layouts</code>. Then create two files: <code>src/layouts/blog.svelte</code> and <code>src/layouts/default.svelte</code>.</p> <p>Then, we’ll just put the same code in both for now so we don’t run into any compile-time errors.</p> <pre class="code-pre line-numbers language-svelte"><code class=language-svelte><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><span class="token comment">//script stuff will go here</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">></span></span>
    <span class="token comment">&lt;!-- your mdsvex content will load here --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"><span class="token comment">/* style stuff will go here */</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span></code></pre> <p>Okay, we have layout files. The next step is to add our <code>svx</code> files to make sure everything works the way we expect it to.</p> <p>In your <code>src/routes</code> directory, create a subdirectory named <code>mdsvex</code>. In that directory create a file called <code>index.svx</code> and put the following in that file:</p> <pre class="code-pre line-numbers language-markdown"><code class=language-markdown><span class="token punctuation hr">---</span>
layout: blog
title: mdsvex test
greeting: Hello, Sapper, Tailwind, and mdsvex!

<span class="token punctuation hr">---</span>

<span class="token important title"><span class="token punctuation">##</span> {title}</span>

<span class="token important title"><span class="token punctuation">##</span> Hey! This is my mdsvex component!</span>

Now this is some content, just because we need to have some content here.</code></pre> <p>mdsvex allows us to use <code>.svx</code> files in place of <code>.svelte</code> files in our routes and components. So, what we’re doing here is setting up a test route so we can make sure everything’s wired up correctly. Because Sapper uses file-based routing, and once we’re finished with the next step, this file will be available at <a href=http://localhost:3000/mdsvex rel=nofollow>http://localhost:3000/mdsvex</a>.</p> <p>Okay, there are two small things that we need to take care of to make sure this will run. First, we need to edit <code>package.json</code> and modify our <code>dev</code> script with an <code>--ext</code> argument, telling the sapper command that we want it to look for both <code>.svx</code> and <code>.svelte</code> files. Just replace the entire <code>"dev": "sapper dev",</code> line with:</p> <pre class="code-pre line-numbers language-json"><code class=language-json><span class="token property">"dev"</span><span class="token operator">:</span> <span class="token string">"sapper dev --ext '.svelte .svx'"</span><span class="token punctuation">,</span></code></pre> <p>We also need to tell <code>rollup-plugin-svelte</code> to look for those extensions. Sapper has configurations for both the client and the server, so we need to make sure the code is in both configuration objects. Open up <code>rollup.config.json</code> and add <code>extensions: ['.svx', '.svelte'],</code> to the svelte plugin config of <strong>both</strong> the <code>client</code> and <code>server</code> sections of that config file:</p> <pre class="code-pre line-numbers language-js"><code class=language-js>client<span class="token operator">:</span> <span class="token punctuation">{</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
			<span class="token comment">// blahblahblah config stuff</span>
			<span class="token function">svelte</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.svx'</span><span class="token punctuation">,</span> <span class="token string">'.svelte'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token comment">// blahblahblah more config stuff</span>
server<span class="token operator">:</span> <span class="token punctuation">{</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
			<span class="token comment">// blahblahblah config stuff</span>
			<span class="token function">svelte</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.svx'</span><span class="token punctuation">,</span> <span class="token string">'.svelte'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token comment">// blahblahblah more config stuff</span></code></pre> <p>Finally! You should be able to run the whole thing with <code>pnpm run dev</code>.</p> <p>Do that and navigate to <a href=http://localhost/mdsvex rel=nofollow>http://localhost/mdsvex</a> to see the glory of what you’ve been working so hard on.</p> <img alt="Behold! Your mdsvex component in action!" height=450 loading=lazy src=img/posts/12-15-20/12-15-20_Screenshot04.png width=800> <p>Okay, so it’s ugly. But, hey, it works! Let’s add some stuff to the <code>blog.svelte</code> layout file so we can check out how variables in the <code>.svx</code> frontmatter can be used by the <code>.svelte</code> file. Just replace everything in blog.svelte with the following:</p> <pre class="code-pre line-numbers language-svelte"><code class=language-svelte><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><span class="token keyword">export</span> <span class="token keyword">let</span> greeting<span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token language-javascript"><span class="token punctuation">{</span>greeting<span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>main</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"><span class="token selector">main</span> <span class="token punctuation">{</span>
		<span class="token property">width</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
		<span class="token property">margin</span><span class="token punctuation">:</span> 3rem auto<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token selector">:global(h1)</span> <span class="token punctuation">{</span>
		<span class="token atrule"><span class="token rule">@apply</span> text-3xl font-black text-red-500<span class="token punctuation">;</span></span>
	<span class="token punctuation">}</span>
	<span class="token selector">:global(h2)</span> <span class="token punctuation">{</span>
		<span class="token atrule"><span class="token rule">@apply</span> text-2xl font-bold mt-12<span class="token punctuation">;</span></span>
	<span class="token punctuation">}</span>
	<span class="token selector">:global(h3)</span> <span class="token punctuation">{</span>
		<span class="token atrule"><span class="token rule">@apply</span> text-xl font-bold mt-8<span class="token punctuation">;</span></span>
	<span class="token punctuation">}</span>
	<span class="token selector">:global(p)</span> <span class="token punctuation">{</span>
		<span class="token atrule"><span class="token rule">@apply</span> mt-4<span class="token punctuation">;</span></span>
	<span class="token punctuation">}</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span></code></pre> <img alt="Very stylish version of an mdsvex component" height=450 loading=lazy src=img/posts/12-15-20/12-15-20_Screenshot05.png width=800> <p>Okay, now you can see that <code>greeting</code>, defined in the frontmatter of <code>index.svx</code> can be used as a prop in the <code>blog.svelte</code> layout file. We can also use the frontmatter properties in the <code>.svx</code> file itself. We can also use Tailwind’s <code>@apply</code> syntax to, well, apply Tailwind class styles to the markdown content that’s added to our layout component. There’s a <em>lot</em> more you can do with mdsvex, and we’ll get into some of it in the next part.</p> <p>That’s enough for one tutorial. We’ll learn how to set up what we’ve got so that we can create a blog with all of these cool libraries in the next part.</section> </main> </div> </div> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,null,{}]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');(function(){try{eval("async function x(){}");var main="/client/client.adf0f3e4.js"}catch(e){main="/client/legacy/client.8dae1ab6.js"};var s=document.createElement("script");try{new Function("if(0)import('')")();s.src=main;s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@2.0.4.js";s.setAttribute("data-main",main);}document.head.appendChild(s);}());</script> 